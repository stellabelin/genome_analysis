
Version 2.04: released on July 13th, 2012
Compile Nov 20 2013	12:17:09

********************
Pregraph
********************

Parameters: pregraph -s confiq_new_parameters.config -K 49 -o /home/stellab/private/genome_analysis/results/3_genome_assembly/kmer_49/new_config 

In confiq_new_parameters.config, 1 lib(s), maximum read length 120, maximum name length 256.

8 thread(s) initialized.
Import reads from file:
 /home/stellab/private/genome_analysis/raw_data/sel3/wgs_data/sel3_SRR5819794.trim_1P.fastq.gz 
Import reads from file:
 /home/stellab/private/genome_analysis/raw_data/sel3/wgs_data/sel3_SRR5819794.trim_2P.fastq.gz 
Import reads from file:
 /home/stellab/private/genome_analysis/raw_data/sel3/wgs_data/sel3_SRR5819795.trim_1P.fastq.gz 
Import reads from file:
 /home/stellab/private/genome_analysis/raw_data/sel3/wgs_data/sel3_SRR5819795.trim_2P.fastq.gz 
Import reads from file:
 /home/stellab/private/genome_analysis/raw_data/sel3/wgs_data/sel3_SRR5819796.trim_1P.fastq.gz 
Import reads from file:
 /home/stellab/private/genome_analysis/raw_data/sel3/wgs_data/sel3_SRR5819796.trim_2P.fastq.gz 
Import reads from file:
 /home/stellab/private/genome_analysis/raw_data/sel3/wgs_data/sel3_SRR5819797.trim_1P.fastq.gz 
Import reads from file:
 /home/stellab/private/genome_analysis/raw_data/sel3/wgs_data/sel3_SRR5819797.trim_2P.fastq.gz 
Import reads from file:
 /home/stellab/private/genome_analysis/raw_data/sel3/wgs_data/sel3_SRR5819798.trim_1P.fastq.gz 
Import reads from file:
 /home/stellab/private/genome_analysis/raw_data/sel3/wgs_data/sel3_SRR5819798.trim_2P.fastq.gz 
Import reads from file:
 /home/stellab/private/genome_analysis/raw_data/sel3/wgs_data/sel3_SRR5819799.trim_1P.fastq.gz 
Import reads from file:
 /home/stellab/private/genome_analysis/raw_data/sel3/wgs_data/sel3_SRR5819799.trim_2P.fastq.gz 
Import reads from file:
 /home/stellab/private/genome_analysis/raw_data/sel3/wgs_data/sel3_SRR5819794.trim_1U.fastq.gz 
Import reads from file:
 /home/stellab/private/genome_analysis/raw_data/sel3/wgs_data/sel3_SRR5819794.trim_2U.fastq.gz 
Import reads from file:
 /home/stellab/private/genome_analysis/raw_data/sel3/wgs_data/sel3_SRR5819795.trim_1U.fastq.gz 
Import reads from file:
 /home/stellab/private/genome_analysis/raw_data/sel3/wgs_data/sel3_SRR5819795.trim_2U.fastq.gz 
Import reads from file:
 /home/stellab/private/genome_analysis/raw_data/sel3/wgs_data/sel3_SRR5819796.trim_1U.fastq.gz 
Import reads from file:
 /home/stellab/private/genome_analysis/raw_data/sel3/wgs_data/sel3_SRR5819796.trim_2U.fastq.gz 
Import reads from file:
 /home/stellab/private/genome_analysis/raw_data/sel3/wgs_data/sel3_SRR5819797.trim_1U.fastq.gz 
Import reads from file:
 /home/stellab/private/genome_analysis/raw_data/sel3/wgs_data/sel3_SRR5819797.trim_2U.fastq.gz 
Import reads from file:
 /home/stellab/private/genome_analysis/raw_data/sel3/wgs_data/sel3_SRR5819798.trim_1U.fastq.gz 
Import reads from file:
 /home/stellab/private/genome_analysis/raw_data/sel3/wgs_data/sel3_SRR5819798.trim_2U.fastq.gz 
Import reads from file:
 /home/stellab/private/genome_analysis/raw_data/sel3/wgs_data/sel3_SRR5819799.trim_1U.fastq.gz 
Import reads from file:
 /home/stellab/private/genome_analysis/raw_data/sel3/wgs_data/sel3_SRR5819799.trim_2U.fastq.gz 
Time spent on hashing reads: 371s, 49384001 read(s) processed.
LIB(s) information:
 [LIB] 0, avg_ins 5500, reverse 1.
231194679 node(s) allocated, 2335886764 kmer(s) in reads, 2335886764 kmer(s) processed.
done hashing nodes
218866346 linear node(s) marked.
Time spent on marking linear nodes: 4s.
Time spent on pre-graph construction: 375s.

Start to remove frequency-one-kmer tips shorter than 98.
Total 3973897 tip(s) removed.
8 thread(s) initialized.
1456875 linear node(s) marked.
Start to remove tips with minority links.
2219953 tip(s) removed in cycle 1.
19488 tip(s) removed in cycle 2.
91 tip(s) removed in cycle 3.
0 tip(s) removed in cycle 4.
Total 2239532 tip(s) removed.
8 thread(s) initialized.
0 linear node(s) marked.
Time spent on removing tips: 114s.

8070403 (4035277) edge(s) and 984172 extra node(s) constructed.
Time spent on constructing edges: 95s.

In file: confiq_new_parameters.config, max seq len 120, max name len 256.
8 thread(s) initialized.
Import reads from file:
 /home/stellab/private/genome_analysis/raw_data/sel3/wgs_data/sel3_SRR5819794.trim_1P.fastq.gz 
Import reads from file:
 /home/stellab/private/genome_analysis/raw_data/sel3/wgs_data/sel3_SRR5819794.trim_2P.fastq.gz 
Import reads from file:
 /home/stellab/private/genome_analysis/raw_data/sel3/wgs_data/sel3_SRR5819795.trim_1P.fastq.gz 
Import reads from file:
 /home/stellab/private/genome_analysis/raw_data/sel3/wgs_data/sel3_SRR5819795.trim_2P.fastq.gz 
Import reads from file:
 /home/stellab/private/genome_analysis/raw_data/sel3/wgs_data/sel3_SRR5819796.trim_1P.fastq.gz 
Import reads from file:
 /home/stellab/private/genome_analysis/raw_data/sel3/wgs_data/sel3_SRR5819796.trim_2P.fastq.gz 
Import reads from file:
 /home/stellab/private/genome_analysis/raw_data/sel3/wgs_data/sel3_SRR5819797.trim_1P.fastq.gz 
Import reads from file:
 /home/stellab/private/genome_analysis/raw_data/sel3/wgs_data/sel3_SRR5819797.trim_2P.fastq.gz 
Import reads from file:
 /home/stellab/private/genome_analysis/raw_data/sel3/wgs_data/sel3_SRR5819798.trim_1P.fastq.gz 
Import reads from file:
 /home/stellab/private/genome_analysis/raw_data/sel3/wgs_data/sel3_SRR5819798.trim_2P.fastq.gz 
Import reads from file:
 /home/stellab/private/genome_analysis/raw_data/sel3/wgs_data/sel3_SRR5819799.trim_1P.fastq.gz 
Import reads from file:
 /home/stellab/private/genome_analysis/raw_data/sel3/wgs_data/sel3_SRR5819799.trim_2P.fastq.gz 
Import reads from file:
 /home/stellab/private/genome_analysis/raw_data/sel3/wgs_data/sel3_SRR5819794.trim_1U.fastq.gz 
Import reads from file:
 /home/stellab/private/genome_analysis/raw_data/sel3/wgs_data/sel3_SRR5819794.trim_2U.fastq.gz 
Import reads from file:
 /home/stellab/private/genome_analysis/raw_data/sel3/wgs_data/sel3_SRR5819795.trim_1U.fastq.gz 
Import reads from file:
 /home/stellab/private/genome_analysis/raw_data/sel3/wgs_data/sel3_SRR5819795.trim_2U.fastq.gz 
Import reads from file:
 /home/stellab/private/genome_analysis/raw_data/sel3/wgs_data/sel3_SRR5819796.trim_1U.fastq.gz 
Import reads from file:
 /home/stellab/private/genome_analysis/raw_data/sel3/wgs_data/sel3_SRR5819796.trim_2U.fastq.gz 
Import reads from file:
 /home/stellab/private/genome_analysis/raw_data/sel3/wgs_data/sel3_SRR5819797.trim_1U.fastq.gz 
Import reads from file:
 /home/stellab/private/genome_analysis/raw_data/sel3/wgs_data/sel3_SRR5819797.trim_2U.fastq.gz 
Import reads from file:
 /home/stellab/private/genome_analysis/raw_data/sel3/wgs_data/sel3_SRR5819798.trim_1U.fastq.gz 
Import reads from file:
 /home/stellab/private/genome_analysis/raw_data/sel3/wgs_data/sel3_SRR5819798.trim_2U.fastq.gz 
Import reads from file:
 /home/stellab/private/genome_analysis/raw_data/sel3/wgs_data/sel3_SRR5819799.trim_1U.fastq.gz 
Import reads from file:
 /home/stellab/private/genome_analysis/raw_data/sel3/wgs_data/sel3_SRR5819799.trim_2U.fastq.gz 
49384001 read(s) processed.
Time spent on:
 importing reads: 64s,
 chopping reads to kmers: 50s,
 searching kmers: 200s,
 aligning reads to edges: 51s,
 searching (K+1)mers: 43s,
 adding pre-arcs: 48s,
 recording read paths: 0s.
0 marker(s) output.
Reads alignment done, 5630399 read(s) deleted, 8540881 pre-arc(s) added.
LIB(s) information:
 [LIB] 0, avg_ins 5500, reverse 1.
Time spent on aligning reads: 468s.

2809884 vertex(es) output.
Overall time spent on constructing pre-graph: 17m.


********************
Contig
********************

Parameters: contig -g /home/stellab/private/genome_analysis/results/3_genome_assembly/kmer_49/new_config -M 1 -s confiq_new_parameters.config 

There are 2809884 kmer(s) in vertex file.
There are 8070403 edge(s) in edge file.
Kmers sorted.
8070403 edge(s) input.
10343250 pre-arcs loaded.
2016792 none-palindrome edge(s) swapped, 0 palindrome edge(s) processed.
8070403 edge(s) sorted.
Arcs sorted.
Start to pinch bubbles, cutoff 0.100000, MAX NODE NUM 3, MAX DIFF NUM 2.
131400 start points, 6858697 dheap nodes.
2235020 pair(s) found, 21100 pair of path(s) compared, 15592 pair(s) merged.
Sequence comparison failed:
 Path crossing deleted edge                         0
 Length difference of two paths greater than two    1693
 Mismatch score greater than cutoff (2)             632
 Mismatch score ratio greater than cutoff (0.1)     0
 Path length shorter than (Kmer-1)                  3183
DFibHeap: 939416 node(s) allocated.
191631 edge(s) concatenated in cycle 1.
1151 edge(s) concatenated in cycle 2.
3 edge(s) concatenated in cycle 3.
0 edge(s) concatenated in cycle 4.
Time spent on pinching bubbles: 21s.
Start to destroy weak inner edges.
265176 weak inner edge(s) destroyed in cycle 1.
1704 weak inner edge(s) destroyed in cycle 2.
9 weak inner edge(s) destroyed in cycle 3.
0 weak inner edge(s) destroyed in cycle 4.
529161 dead arc(s) removed.
44367 inner edge(s) with coverage lower than or equal to 1 destroyed.
96285 dead arc(s) removed.
431929 edge(s) concatenated in cycle 1.
2812 edge(s) concatenated in cycle 2.
0 edge(s) concatenated in cycle 3.
Before compacting, 8070403 edge(s) existed.
After compacting, 6160773 edge(s) left.

Strict: 0, cutoff length: 98.
456817 tips cut in cycle 1.
82934 tips cut in cycle 2.
18709 tips cut in cycle 3.
5344 tips cut in cycle 4.
2054 tips cut in cycle 5.
878 tips cut in cycle 6.
433 tips cut in cycle 7.
199 tips cut in cycle 8.
93 tips cut in cycle 9.
33 tips cut in cycle 10.
10 tips cut in cycle 11.
12 tips cut in cycle 12.
13 tips cut in cycle 13.
9 tips cut in cycle 14.
10 tips cut in cycle 15.
13 tips cut in cycle 16.
7 tips cut in cycle 17.
0 tips cut in cycle 18.
347162 dead arc(s) removed.
248035 edge(s) concatenated in cycle 1.
1553 edge(s) concatenated in cycle 2.
3 edge(s) concatenated in cycle 3.
0 edge(s) concatenated in cycle 4.
Before compacting, 6160773 edge(s) existed.
After compacting, 4526455 edge(s) left.

There are 344218 contig(s) longer than 100, sum up 67839647 bp, with average length 197.
The longest length is 16563 bp, contig N50 is 202 bp,contig N90 is 119 bp.
2263297 contig(s) longer than 50 output.

Time spent on constructing contig: 1m.


********************
Map
********************

Parameters: map -s confiq_new_parameters.config -g /home/stellab/private/genome_analysis/results/3_genome_assembly/kmer_49/new_config -K 49 

Kmer size: 49.
Contig length cutoff: 51.

2263297 contig(s), maximum sequence length 16563, minimum sequence length 50, maximum name length 10.
Time spent on parsing contigs file: 0s.
8 thread(s) initialized.
Time spent on hashing contigs: 14s.
66209216 node(s) allocated, 68128237 kmer(s) in contigs, 68128237 kmer(s) processed.
Time spent on graph construction: 14s.

Time spent on aligning long reads: 0s.

In file: confiq_new_parameters.config, max seq len 120, max name len 256
8 thread(s) initialized.
4526455 edge(s) in the graph.
Import reads from file:
 /home/stellab/private/genome_analysis/raw_data/sel3/wgs_data/sel3_SRR5819794.trim_1P.fastq.gz 
Import reads from file:
 /home/stellab/private/genome_analysis/raw_data/sel3/wgs_data/sel3_SRR5819794.trim_2P.fastq.gz 
Current insert size is 5500, map_len is 35.
Import reads from file:
 /home/stellab/private/genome_analysis/raw_data/sel3/wgs_data/sel3_SRR5819795.trim_1P.fastq.gz 
Import reads from file:
 /home/stellab/private/genome_analysis/raw_data/sel3/wgs_data/sel3_SRR5819795.trim_2P.fastq.gz 
Import reads from file:
 /home/stellab/private/genome_analysis/raw_data/sel3/wgs_data/sel3_SRR5819796.trim_1P.fastq.gz 
Import reads from file:
 /home/stellab/private/genome_analysis/raw_data/sel3/wgs_data/sel3_SRR5819796.trim_2P.fastq.gz 
Import reads from file:
 /home/stellab/private/genome_analysis/raw_data/sel3/wgs_data/sel3_SRR5819797.trim_1P.fastq.gz 
Import reads from file:
 /home/stellab/private/genome_analysis/raw_data/sel3/wgs_data/sel3_SRR5819797.trim_2P.fastq.gz 
Import reads from file:
 /home/stellab/private/genome_analysis/raw_data/sel3/wgs_data/sel3_SRR5819798.trim_1P.fastq.gz 
Import reads from file:
 /home/stellab/private/genome_analysis/raw_data/sel3/wgs_data/sel3_SRR5819798.trim_2P.fastq.gz 
Import reads from file:
 /home/stellab/private/genome_analysis/raw_data/sel3/wgs_data/sel3_SRR5819799.trim_1P.fastq.gz 
Import reads from file:
 /home/stellab/private/genome_analysis/raw_data/sel3/wgs_data/sel3_SRR5819799.trim_2P.fastq.gz 

Total reads         43938106
Reads in gaps       25854018
Ratio               58.8%
Reads on contigs    33181017
Ratio               75.5%
1 pe insert size, the largest boundary is 43938106.

LIB(s) information:
 [LIB] 0, avg_ins 5500, reverse 1.
Time spent on aligning reads: 433s.

Overall time spent on alignment: 7m.


********************
Scaff
********************

Parameters: scaff -g /home/stellab/private/genome_analysis/results/3_genome_assembly/kmer_49/new_config 

Files for scaffold construction are OK.

There are 1 grad(s), 43938106 read(s), max read len 120.
Kmer size: 49
There are 4526455 edge(s) in edge file.
Mask contigs with coverage lower than 1.2 or higher than 24.0, and strict length 0.
Average contig coverage is 12, 1653924 contig(s) masked.
Mask contigs shorter than 51, 2300880 contig(s) masked.
6068986 arc(s) loaded, average weight is 7.
2263297 contig(s) loaded.
Done loading updated edges.
Time spent on loading updated edges: 14s.

*****************************************************
Start to load paired-end reads information.

For insert size: 5500
 Total PE links                      13089447
 Normal PE links on same contig      662633
 Incorrect oriented PE links         93028
 PE links of too small insert size   32398
 PE links of too large insert size   0
 Correct PE links                    10730828
 Accumulated connections             5673010
Use contigs longer than 5500 to estimate insert size: 
 PE links               75280
 Average insert size    1754
 SD                     2083
2836505 new connections.

All paired-end reads information loaded.
Time spent on loading paired-end reads information: 25s.

*****************************************************
Start to construct scaffolds.

***************************
For insert size: 5500
 Total PE links                2836504
 PE links to masked contigs    2621437
 On same scaffold PE links     0
Cutoff of PE links to make a reliable connection: 5
Report from checkScaf: 0 scaffold segments broken.
 Active connections    430134
 Weak connections      291102
 Weak ratio            67.7%
1 circles removed.
Start to remove transitive connection.
Total contigs                         4526455
Masked contigs                        3954808
Remained contigs                      571647
None-outgoing-connection contigs      449776 (78.680725%)
Single-outgoing-connection contigs    105773
Multi-outgoing-connection contigs     1095
Cycle 1
 Two-outgoing-connection contigs     15003
 Potential transitive connections    1312
 Transitive connections              780
 Transitive ratio                    5.2%
Cycle 2
 Two-outgoing-connection contigs     14201
 Potential transitive connections    532
 Transitive connections              0
 Transitive ratio                    0.0%
Start to linearize sub-graph.
 Picked sub-graphs          10099
 Connection-conflict        35
 Significant overlapping    3833
 Eligible                   2
 Bubble structures          0
Mask repeats:
 Puzzles           2843
 Masked contigs    2723
Start to remove transitive connection.
Total contigs                         4526455
Masked contigs                        3960254
Remained contigs                      566201
None-outgoing-connection contigs      448889 (79.280853%)
Single-outgoing-connection contigs    117239
Multi-outgoing-connection contigs     2
Cycle 1
 Two-outgoing-connection contigs     71
 Potential transitive connections    43
 Transitive connections              33
 Transitive ratio                    46.5%
Cycle 2
 Two-outgoing-connection contigs     38
 Potential transitive connections    10
 Transitive connections              0
 Transitive ratio                    0.0%
Start to linearize sub-graph.
 Picked sub-graphs          32
 Connection-conflict        8
 Significant overlapping    5
 Eligible                   0
 Bubble structures          0
Non-strict linearization.
Start to linearize sub-graph.
 Picked sub-graphs          13
 Connection-conflict        8
 Significant overlapping    4
 Eligible                   0
 Bubble structures          0
Start to mask puzzles.
 Masked contigs      8
 Remained puzzles    0
Freezing done.

Recover contigs.
 Total recovered contigs    0
 Single-route cases         0
 Multi-route cases          0

All links loaded.
Time spent on constructing scaffolds: 7s.

The final rank

*******************************
 Scaffold number                  36443
 In-scaffold contig number        344214
 Total scaffold length            290673644
 Average scaffold length          7976
 Filled gap number                1286
 Longest scaffold                 65176
 Scaffold and singleton number    285646
 Scaffold and singleton length    326480876
 Average length                   1142
 N50                              5659
 N90                              440
 Weak points                      0

*******************************
1000 scaffolds processed.
2000 scaffolds processed.
3000 scaffolds processed.
4000 scaffolds processed.
5000 scaffolds processed.
6000 scaffolds processed.
7000 scaffolds processed.
8000 scaffolds processed.
9000 scaffolds processed.
10000 scaffolds processed.
11000 scaffolds processed.
12000 scaffolds processed.
13000 scaffolds processed.
14000 scaffolds processed.
15000 scaffolds processed.
16000 scaffolds processed.
17000 scaffolds processed.
18000 scaffolds processed.
19000 scaffolds processed.
20000 scaffolds processed.
21000 scaffolds processed.
22000 scaffolds processed.
23000 scaffolds processed.
24000 scaffolds processed.
25000 scaffolds processed.
26000 scaffolds processed.
27000 scaffolds processed.
28000 scaffolds processed.
29000 scaffolds processed.
30000 scaffolds processed.
31000 scaffolds processed.
32000 scaffolds processed.
33000 scaffolds processed.
34000 scaffolds processed.
35000 scaffolds processed.
36000 scaffolds processed.

Done with 36443 scaffolds, 0 gaps finished, 58579 gaps overall.

Overall time spent on constructing scaffolds: 42m.
Time for the whole pipeline: 69m.
